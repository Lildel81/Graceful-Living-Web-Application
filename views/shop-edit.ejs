<link rel="stylesheet" href="/css/shop.css">

<div class="gl-shop" style="max-width: 720px; margin: 2rem auto; padding-top: 10%;">
  <h1 class="gl-shop-title"><%= title || ('Edit: ' + (product?.title || 'Product')) %></h1>

  <% if (typeof error === 'string' && error) { %>
    <div class="gl-error" style="background:#fee; border:1px solid #f99; padding:0.75rem; border-radius:8px; margin-bottom:1rem;">
      <strong>There was a problem:</strong> <%= error %>
    </div>
  <% } %>

  <form method="POST" action="/shop/admin/<%= product._id %>">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

    <div class="gl-field">
      <label>Title</label>
      <input name="title" required value="<%= product.title %>">
      <small class="gl-muted">Current URL: /shop/<%= product.slug %></small><br>
      <label style="display:flex; gap:0.5rem; align-items:center; margin-top:0.25rem;">
        <input type="checkbox" name="updateSlug"> Update URL from title
      </label>
    </div>

    <div class="gl-field">
      <label>Price</label>
      <div style="display:flex; gap:0.5rem; align-items:center;">
        <span>$</span>
        <input name="priceDollars" type="number" step="0.01" min="0"
               value="<%= (product.priceCents/100).toFixed(2) %>">
      </div>
      <input type="hidden" name="priceCents" value="<%= product.priceCents %>">
    </div>

    <div class="gl-field">
      <label>Stock</label>
      <input name="stock" type="number" min="0" value="<%= product.stock %>">
    </div>

    <div class="gl-field">
      <label>Active</label>
      <label style="display:flex; gap:0.5rem; align-items:center;">
        <input type="checkbox" name="active" <%= product.active ? 'checked' : '' %> > Visible in shop
      </label>
    </div>

    <div class="gl-field">
      <label>Description</label>
      <textarea name="description" rows="6"><%= product.description %></textarea>
      <small class="gl-muted">Photo remains the same. If you need to change it, delete and recreate.</small>
    </div>

    <div class="gl-field">
      <% if (product.imagePath) { %>
        <label>Current Photo</label><br>
        <img src="<%= product.imagePath %>" alt="" style="max-width:240px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.08);">
      <% } %>
    </div>

    <div class="gl-actions" style="display:flex; gap:0.5rem;">
      <button type="submit" class="btn">Save Changes</button>
      <a class="btn" href="/shop/admin/list" style="background:#f4f4f4; color:#333;">Cancel</a>
    </div>
  </form>
</div>
