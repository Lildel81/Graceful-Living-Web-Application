<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>GracefulLiving - Content Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Inter:wght@300;400;500;600;700&family=Source+Serif+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/content-management.css">
</head>
<body>
    <!-- Fixed Back Button -->
    <div class="fixed-back-button">
        <a href="/adminportal"><button>Back to Admin Portal</button></a>
    </div>

    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <div class="hero-text">
            <p>Create content that speaks life,<br>inspires peace, and uplifts the soul!</p>
        </div>
        
        <!-- Content Hub Tabs -->
        <nav class="tabs-nav" aria-label="Content sections">
            <button class="tab active" data-target="panel-carousel">Carousel</button>
            <button class="tab" data-target="panel-quote">Homepage Quote</button>
            <button class="tab" data-target="panel-video">Intro Video</button>
            <button class="tab" data-target="panel-services">Services</button>
            <button class="tab" data-target="panel-voices">Testimonial</button>
            <button class="tab" data-target="panel-about">About Us</button>
            <button class="tab" data-target="panel-quiz">Chakra Quiz</button>
            <button class="tab" data-target="panel-resources">Resources</button>
            <button class="tab" data-target="panel-contact">Contact</button>
        </nav>

        <!-- Panels -->
        <!-- Carousel panel (restored so tab has a target) -->
        <section id="panel-carousel" class="panel active">
            <h2>Carousel Management</h2>
            <p>Manage homepage carousel images and ordering.</p>
            <div class="iframe-container">
                <iframe src="/adminportal/carouselmanagement" title="Carousel Manager"></iframe>
            </div>
        </section>

        <!-- Testimonials panel (single source of truth -> iframe to manager) -->
        <section id="panel-voices" class="panel">
            <h2>Testimonials</h2>
            <p>Manage testimonials shown on the Reviews page.</p>
            <div class="iframe-container">
                <iframe src="/admin/testimonials" title="Testimonials Manager"></iframe>
            </div>
        </section>


        <section id="panel-quote" class="panel">
            <h2>Homepage Quote</h2>
            <div class="iframe-container">
                <iframe src="/adminportal/homequote-settings" title="Home Quote"></iframe>
            </div>
        </section>

        <!-- <section id="panel-video" class="panel">
            <h2>Introduction Video</h2>
            <form action="#" method="POST" onsubmit="event.preventDefault(); alert('Hook up endpoint to save intro video URL.');">
                <label for="introVideoUrl">Video URL (YouTube, Vimeo, or MP4)</label>
                <input type="url" id="introVideoUrl" name="introVideoUrl" placeholder="https://...">
                <div class="actions">
                    <button class="btn" type="submit">Save Video</button>
                </div>
            </form>
        </section> -->
        <section id="panel-video" class="panel">
            <h2>Introduction Video</h2>
            <p>Paste a YouTube embed link or any valid video URL to update the intro video shown on the homepage.</p>

            <form
                id="introVideoForm" 
                action="/adminportal/update-intro-video" 
                method="POST"
                class="admin-form"
            >
                <!-- CSRF Protection -->
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <!-- Video URL Input -->
                <div class="form-group">
                    <label for="videoUrl">Video URL (YouTube, Vimeo, or MP4)</label>
                    <input 
                        type="url" 
                        id="videoUrl" 
                        name="videoUrl" 
                        class="form-control"
                        placeholder="https://www.youtube.com/embed/YourVideoID"
                        value="<%= introVideo && introVideo.videoUrl ? introVideo.videoUrl : '' %>"
                        required
                    >
                </div>

                <!-- Preview (optional, dynamic JS update) -->
                <div id="videoPreview" class="video-preview" style="margin-top: 1rem;">
                    <% if (introVideo && introVideo.videoUrl) { %>
                        <iframe 
                        src="<%= introVideo.videoUrl %>" 
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen
                        width="480" 
                        height="270">
                        </iframe>
                    <% } else { %>
                        <p>No video set yet.</p>
                    <% } %>
                </div>

                <!-- Save Button -->
                <div class="actions">
                    <button class="btn" type="submit">Save Video</button>
                </div>
            </form>

            <!-- Optional JS for live preview -->
            <script>
                const videoUrlInput = document.getElementById('videoUrl');
                const preview = document.getElementById('videoPreview');
                videoUrlInput?.addEventListener('input', e => {
                    const url = e.target.value.trim();
                    if (url) {
                        preview.innerHTML = `<iframe src="${url}" frameborder="0" allowfullscreen width="480" height="270"></iframe>`;
                    } else {
                        preview.innerHTML = '<p>No video set yet.</p>';
                    }
                });
            </script>
        </section>

        <section id="panel-services" class="panel">
            <h2>Services</h2>

            <div class="iframe-container">
                <iframe src="/adminportal/servicesmanagement" title="Services Management"></iframe>
            </div>
        </section>

        <!-- Removed duplicated second #panel-voices with old /admin/add-review form -->

        <section id="panel-about" class="panel">
            <h2>About Us</h2>

            <div class="iframe-container">
                <iframe src="/adminportal/aboutusmanagement" title="About Us Management"></iframe>
            </div>
        </section>

        <section id="panel-quiz" class="panel">
            <h2>Chakra Quiz</h2>
            <p>Manage copy, intro text, or link to the quiz.</p>
            <form action="#" method="POST" onsubmit="event.preventDefault(); alert('Hook up endpoint to save Chakra Quiz content.');">
                <label for="quizIntro">Quiz intro/description</label>
                <textarea id="quizIntro" name="quizIntro" placeholder="Short intro displayed before the quiz..."></textarea>
                <div class="actions">
                    <a class="btn secondary" href="/assessment">Open Quiz</a>
                    <button class="btn" type="submit">Save Quiz Content</button>
                </div>
            </form>
        </section>

        <section id="panel-resources" class="panel">
            <h2>Resources</h2>
            <p>Manage resources shown on the Resources page.</p>
            <div class="iframe-container">
                <iframe src="/adminportal/resourcesmanagement" title="Resources Manager"></iframe>
            </div>
        </section>

        <section id="panel-contact" class="panel">
            <h2>Footer Contact</h2>
            <div class="iframe-container">
                <iframe src="/adminportal/footer-settings" title="Footer Settings"></iframe>
            </div>
        </section>

        <script src="/js/content-management.js" defer></script>
        <!-- <script>
            // Check if redirected with ?submitted=true
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('submitted') === 'true') {
              alert('âœ… Testimonial submitted successfully!');
            }
          </script> -->
    </main>
</body>
</html>
